<!DOCTYPE html>
<html lang="en" >

<head>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>

    <meta name="description" content="Entscheidungsspiel: Mauerfall"/>
    <meta name="theme-color" content="#FAC07E"/>
    <meta name="keywords" content="Mauerfall, Berlin, Spiel"/>
    <meta name="author" content="Bergus"/>

    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Quiz zum Mauerfall"/>
    <meta property="og:description" content="Ein Quiz zum &#x0A; Mauerfall 1989 in Berlin &#x0A;"/>
    <meta property="og:image" content="./assets/icon.png"/>

    <link rel="icon" type="image/x-icon" href="./assets/icon.png"/>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>

    <title>Quiz zum Mauerfall</title>



    <style>

        @import url("https://fonts.googleapis.com/css2?family=Orbitron&display=swap");
        @import url("https://fonts.googleapis.com/css2?family=Amatic+SC&display=swap");

        @import url("https://fonts.googleapis.com/css?family=Varela+Round");
        @import url("https://fonts.googleapis.com/css?family=Montserrat:500");
        @import url("https://fonts.googleapis.com/css2?family=Poppins&display=swap");
        @import url("https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i");

        @font-face {
            font-family: "Varela Round", sans-serif;
        }

        ::-moz-selection {
            color: #FAC07E;
            background: rgba(250, 192, 125, 0);
        }

        ::selection {
            color: #FAC07E;
            background: rgba(250, 192, 125, 0);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        *:focus,
        *:active {
            outline: none !important;
            -webkit-tap-highlight-color: transparent;
        }

        html,
        body {
            overflow: hidden;

            color: #CFCFCF;
            font-family: "Varela Round", sans-serif;

            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Button */

        button {
            padding: 9px 25px;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            font-family: "Montserrat", sans-serif;
            font-weight: 500;
            font-size: 20px;
            text-decoration: none;

            box-shadow: 0 5px 5px rgba(0, 0, 0, 0.15);

            box-sizing: border-box;
            margin: 0;

            text-align: center;
            letter-spacing: 0.0475em;
            line-height: 1.35;

            transition: all 0.3s ease 0s;
            -webkit-transition: all 0.3s ease 0s;

            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;

            -webkit-animation: none;
            -moz-animation: none;
            animation: none;
        }

        button:hover {
            font-size: 25px;

            transform: translate(0, -7.5%);

            transition: all 0.3s ease 0s;
            -webkit-transition: all 0.3s ease 0s;

            text-shadow:
                    0 0 0 rgba(255, 255, 255, 0.5),
                    0 0 5px rgba(255, 255, 255, 0.5),
                    0 0 10px rgba(255, 255, 255, 0.5)
        }

        /* Start Button */

        .start-button {
            position: absolute;
            display: none;
            z-index: 3;
            top: 50%;
            left: 0;
            right: 0;
            margin-left: auto;
            margin-right: auto;
            min-width: 150px;
            width: 10%;
        }

        /* Header & Icon Container */

        .header {
            top: 0;
            width: 100%;
            position: absolute;

            background-color: #00000000;

            transition: all 0.5s ease 0s;
            -webkit-transition: all 0.5s ease 0s;
            visibility: visible;
        }

        .icon-container {
            transform: translateZ(0) scale(1);
            -webkit-transform: translateZ(0) scale(1);
            z-index: 8;

            background-color: #00000000;

            width: 550px;
            height: 100px;
            display: flex;
            flex-direction: row;
            align-items: center;
            text-align: center;

            left: 15px;
            bottom: 5px;
            margin-left: 15px;

            font-family: Nunito, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, sans-serif;
            place-items: center;
        }

        .icon-wrapper {
            display: inline-flex;
        }

        .icon-wrapper .icon {
            box-shadow: 0 10px 10px rgba(0, 0, 0, 0.1);
            background-color: #FFFFFF;
            color: #2F2f2f;

            position: relative;
            border-radius: 50px;

            padding: 15px;
            margin: 10px;
            width: 50px;
            height: 50px;
            font-size: 18px;

            display: flex;
            flex-direction: column;
            text-align: center;
            align-items: center;
            justify-content: center;

            cursor: pointer;

            transition: all 0.5s ease 0.05s;
            -webkit-transition: all 0.5s ease 0.05s;

            transform: translateY(5px);
            -webkit-transform: translateY(5px);
        }

        .icon:active {
            transform: translateY(5px);
            -webkit-transform: translateY(5px);
        }

        .icon-wrapper .icon:hover {
            font-size: 21px;

            width: 200px;
            align-items: normal;

            transition: all 0.25s ease 0s;
            -webkit-transition: all 0.25s ease 0s;
        }

        .icon-wrapper .icon:hover span {
            text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.1);

            transition: all 0.5s ease 0.05s;
            -webkit-transition: all 0.5s ease 0.05s;
        }

        /* Icons */

        .icon-wrapper .theme:hover {
            background-color: #DE463D;
            color: #FFFFFF;
        }

        .icon-wrapper .score:hover {
            background-color: #7288DA;
            color: #FFFFFF;
        }
        
        .icon-wrapper .sound:hover {
            background-color: #7288DA;
            color: #FFFFFF;
        }

    </style>

</head>

<body translate="no" onload="init()">

<!-- Header -->

<div class="header">
    <div class="icon-container icon-wrapper" style="z-index: 5;">
        <a class="icon theme" style="width: 75px;"><div id="theme" onclick="theme()">Light</div></a>
        <a class="icon sound" style="width: 110px;"><div id="sound" onclick="mute()">Mute</div></a>
        <a class="icon score" style="min-width: 110px;"><div id="score">Score: 0</div></a>
    </div>
</div>

<!-- Start Game Button -->

<button id="start-button" class="start-button" style="background-color: #f0af6e; color: #EAEAEA;" onclick="start()">Start</button>

<!-- Java Script -->

<script>
    const canvas = document.createElement('canvas');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    document.body.appendChild(canvas);
    const context = canvas.getContext('2d');

    // Context Line Fix

    context.miterLimit = 1;
    context.lineJoin = "round";
    context.textAlign = "left";

    // Element Sizing

    let size_value = (window.innerWidth + window.innerHeight) / 2;
    let prev_size_value = size_value;

    let prev_width = window.innerWidth;

    // Waves

    wave_speed = 0.15;
    wave_height = 35;
    nodes = 6;
    waves = [];

    // Mouse

    let prev_mouse_x = 0;
    let prev_mouse_y = 0;

    let mouse_x = 0;
    let mouse_y = 0;

    // Levels

    const levels = [];
    let level = 0;

    const start_button = document.getElementById("start-button");
    let started = false;

    let score = 0;

    let text_color = "#EFEFEF";

    // Game Effects

    let hover_cooldown = 0;
    let click_cooldown = 0;
    let theme_cooldown = 0;
    
    let muted = false;

    let background_music = new Audio("assets/background-music.mp3");
    const hover_sound = new Audio("assets/input-hover.mp3");
    const click_sound = new Audio("assets/input-click.mp3");
    const wrong_sound = new Audio("assets/input-wrong.mp3");

    background_music.loop = true;
    background_music.volume = 0.05;
    background_music.load();

    hover_sound.volume = 0.5;
    hover_sound.load();

    click_sound.volume = 1;
    click_sound.load();

    wrong_sound.volume = 1;
    wrong_sound.load();

    // Images

    const image_1 = new Image();
    const image_2 = new Image();
    const image_3 = new Image();
    const image_4 = new Image();
    const image_5 = new Image();
    const image_6 = new Image();
    const image_7 = new Image();
    const image_8 = new Image();
    const image_9 = new Image();
    const image_10 = new Image();
    const image_11 = new Image();
    const image_12 = new Image();
    const image_13 = new Image();

    image_1.src = "assets/mauerfall-car.jpg";
    image_2.src = "assets/mauerfall-people-1.jpg";
    image_3.src = "assets/mauerfall-people-2.jpg";
    image_4.src = "assets/mauerfall-people-3.jpg";
    image_5.src = "assets/wall-1.jpg";
    image_6.src = "assets/wall-2.jpg";
    image_7.src = "assets/wall-3.jpg";
    image_8.src = "assets/wall-picture-1.jpg";
    image_9.src = "assets/wall-picture-2.jpg";
    image_10.src = "assets/wall-picture-3.jpg";
    image_11.src = "assets/wall-picture-4.jpg";
    image_12.src = "assets/mauerfall-demonstration.jpg";
    image_13.src = "assets/sed-image.jpg";

    // Initialisation

    function init() {
        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 1:", "Wann begann der Bau der innerdeutschen Grenze?"],
            [["in der Nacht vom 12. zum 13. August 1961", 1], ["3. November 1968", 0], ["beginnend vom 13. August 1951", 0]],
            null
        ));

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 2:", "Monate vor dem Fall der Mauer:"],
            [["sank die Zahl der Fluchtversuche", 0], ["fanden in den größten ostdeutschen Städten Montagsdemonstrationen statt", 1], ["gab es einen wirtschaftlichen Aufschwung in der DDR", 0]],
            null
        ));

        // Information

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Info 1:", "Die Montagsdemonstrationen fanden zuerst in Leipzig statt", "und wurden erst im Herbst in Dresden, Halle", "und weiteren Städten begonnen."],
            [["weiter", 2]],
            image_12
        ));

        // Continuing Levels

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 3:", "Wo fanden die sogenannten Montagsgebete", "und -demonstrationen am Anfang der Revolution statt?"],
            [["Erfurt", 0], ["Leipzig", 1], ["Dresden", 0]],
            null
        ));

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 4:", "Wer war das Staatsoberhaupt der DDR zur Zeit des Mauerfalls?"],
            [["Günter Schabowski", 0], ["Egon Krenz", 1]],
            null
        ));

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 5:", "Welche Partei regierte die DDR zur Zeit der friedlichen Revolution?"],
            [["SPD", 0], ["SED", 1], ["CDU", 0], ["KPD", 0]],
            null
        ));

        // Information

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Info 2:", "SED bedeutet \"Sozialistische Einheitspartei Deutschlands\",", "sie wurde am 21. April 1946 gegründet."],
            [["weiter", 2]],
            image_13
        ));

        // Continuing Levels

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 6:", "An welchem Tag fiel die Mauer?"],
            [["9. November 1989", 1], ["3. November 1989", 0], ["9. November 1979", 0]],
            null
        ));

        // Information

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Info 3:", "Nach dem Fall der Mauer gab es das sogennente", "Begrüßungsgeld in DM (Deutsche Mark).", "Auf dem Bild sind die Warteschlangen vor den", "Banken zu sehen."],
            [["weiter", 2]],
            image_4
        ));

        // Continuing Levels

        levels.push(new Level(
            ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"],
            ["Frage 7:", "Wer verkündete den Mauerfall in der ehemaligen DDR?"],
            [["Michail Gorbatschow", 0], ["Günter Schabowski", 1], ["Willi Stoph", 0]],
            null
        ));

        levels.push(new Level(
            ["#6EB8C2", "#6BB0BA", "#64ABB5", "#5BA2AC"],
            ["Frage 8:", "Wie lang war die Mauergrenzanlage um West-Berlin?"],
            [["187 km", 0], ["98 km", 0], ["155 km", 1]],
            null
        ));

        levels.push(new Level(
            ["#6EB8C2", "#6BB0BA", "#64ABB5", "#5BA2AC"],
            ["Frage 9:", "Wie wurde der Fall der Berliner Mauer verkündet?"],
            [["die Öffnung der Grenzen wurde am Ende einer Pressekonferenz publiziert", 1], ["das Reisegesetz wurde durch Günter Schabowski geändert", 0]],
            null
        ));

        levels.push(new Level(
            ["#6EB8C2", "#6BB0BA", "#64ABB5", "#5BA2AC"],
            ["Frage 10:", "Wie lange war Mauer geschlossen?"],
            [["28 Jahre", 1], ["32 Jahre", 0], ["56 Jahre", 0]],
            null
        ));

        levels.push(new Level(
            ["#6EB8C2", "#6BB0BA", "#64ABB5", "#5BA2AC"],
            ["Frage 11:", "Wie viele Fluchtversuche gab es zwischen 1961 und 1989?"],
            [["12.000", 0], ["35.000", 0], ["75.000", 1]],
            null
        ));

        levels.push(new Level(
            ["#6EB8C2", "#6BB0BA", "#64ABB5", "#5BA2AC"],
            ["Frage 12:", "Die Öffnung der Grenzen bereitete den ersten Schritt für:"],
            [["die Wiedervereinigung Deutschlands", 1], ["mehr Touristen, die West-Berlin besuchen", 0]],
            null
        ));

        levels.push(new Level(
            ["#77B06E", "#B3E67B", "#a7d773", "#95c067"],
            ["Frage 13:", "Warum wurde die Mauer gebaut?"],
            [["um die Einwohner der BRD daran zu hindern, in die DDR zu reisen", 0], ["um die Einwohner der DDR daran zu hindern, ihr Land zu verlassen", 1]],
            null
        ));

        // Information

        levels.push(new Level(
            ["#77B06E", "#B3E67B", "#a7d773", "#95c067"],
            ["Info 4:", "Auf dem Bild im Hintergrund ist der", "sogenannte Todesstreifen zu sehen.", "Hier fanden viele DDR-Bürger beim", "Fluchtversuch den Tod."],
            [["weiter", 2]],
            image_7
        ));

        // Continuing Levels

        levels.push(new Level(
            ["#77B06E", "#B3E67B", "#a7d773", "#95c067"],
            ["Frage 14:", "Warum verlassen 1989 viele die DDR?"],
            [["hohe Arbeitslosigkeit", 0], ["Mangelwirtschaft und Wahlfälschungen", 1]],
            null
        ));

        levels.push(new Level(
            ["#77B06E", "#B3E67B", "#a7d773", "#95c067"],
            ["Frage 15:", "Wie lauten die ersten Worte der Nationalhymne der DDR?"],
            [["\"Auferstanden aus Ruinen und der Zukunft zugewandt... \"", 1], ["\"Einigkeit und Recht und Freiheit.. \"", 0]],
            null
        ));

        // Adding Start Button

        start_button.style.display = "unset";

        // Initialising Waves

        for (let i = 0; i < 3; i++) {
            waves.push(new Wave(levels[level].colors[i + 1], nodes, wave_speed, Math.pow(i + 1, 5) - 100));
        }

        // Initialising Drawing

        draw();
    }

    // Resize Event

    addEventListener('resize', () => {
        prev_width = canvas.width;

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Updating Tile Sizes

        prev_size_value = size_value;
        size_value = (window.innerWidth + window.innerHeight) / 2;

        // Updating Waves

        for (let i = 0; i < waves.length; i++) {
            waves[i].update();
        }
    });

    // Mouse Click Event

    addEventListener('click', (event) => {
        if (started) {
            levels[level].mouse_clicked(event.x, event.y);
        }
    });

    // Key Event

    addEventListener('keydown', (event) => {
        if (started) {
            const key = parseInt(event.key);

            if (key >= 0 && key <= 9) {
                levels[level].key_pressed(key);
            }
        }
    });

    // Mouse Move Event

    addEventListener('mousemove', (event) => {
        prev_mouse_x = mouse_x;
        prev_mouse_y = mouse_y;

        mouse_x = event.x;
        mouse_y = event.y;
    });

    // Change Theme

    function theme() {
        if (theme_cooldown === 0) {
            if (text_color === "#EFEFEF") {
                text_color = "#323232";
                document.getElementById("theme").textContent = "Dark";
            } else {
                text_color = "#EFEFEF"
                document.getElementById("theme").textContent = "Light";
            }

            theme_cooldown = 25;
        }
    }
    
    // Mute Sounds
    
    function mute() {
        if (muted) {
            background_music = new Audio("assets/background-music.mp3");
            background_music.loop = true;
            background_music.volume = 0.05;
            background_music.load();
            background_music.play();
            muted = false;
            document.getElementById("sound").textContent = "Mute";
        } else {
            background_music.loop = false;
            background_music.pause();
            background_music = new Audio("assets/background-music.mp3");
            background_music.loop = true;
            background_music.volume = 0.05;
            background_music.load();
            muted = true;
            document.getElementById("sound").textContent = "Unmute";
        }
    }

    // Start Game

    function start() {
        if (!muted) {
            background_music.play();
        }

        start_button.hidden = true;
        start_button.style.display = "none";

        started = true;
    }

    // Drawing

    function draw() {
        context.clearRect(0, 0, canvas.width, canvas.height);
        const wobble = Math.sin(Date.now() / 500) * window.innerHeight / 150;

        // Updating Waves

        if (level < levels.length) {
            for (let i = 0; i < waves.length; i++) {
                waves[i].color = levels[level].colors[i + 1];
            }
        } else {
            for (let i = 0; i < waves.length; i++) {
                waves[i].color = ["#FAD7A0", "#FFCC86", "#FAC07E", "#F4B675"][i + 1];
            }
        }

        // Rendering Waves

        context.fillStyle = level < levels.length ? levels[level].colors[0] : "#FAD7A0";
        context.fillRect(0, 0, canvas.width, canvas.height);

        shadow("#35353575", 25, 0);

        for (let i = 0; i < this.waves.length; i++) {
            for (let j = 0; j < this.waves[i].nodes.length; j++) {
                bounce(this.waves[i], this.wave_height, this.waves[i].nodes[j]);
            }

            if (i === 2 && level < levels.length && levels[level].image !== null && started && window.innerWidth > 800) {
                context.translate(levels[level].img_x, levels[level].img_y);
                context.rotate(levels[level].img_rot);
                context.translate(-levels[level].img_x, -levels[level].img_y);
                context.drawImage(levels[level].image, levels[level].img_x, levels[level].img_y);
                context.resetTransform();
            }

            this.waves[i].draw();
        }

        reset_shadow();

        // Header

        if (!started) {
            context.font = (size_value / 25) + "px Montserrat";

            let header_x = window.innerWidth / 2 - context.measureText("Quiz zum Mauerfall").width / 2;
            let header_y = window.innerHeight / 3 - wobble;

            // Rendering Header Hover Layer

            reset_shadow();

            context.fillStyle = text_color;

            context.fillText(
                "Quiz zum Mauerfall",
                header_x,
                header_y
            );

            // Rendering Header Shadow Layer

            context.fillStyle = text_color;
            shadow("#00000050", 15, size_value / 200);

            context.fillText(
                "Quiz zum Mauerfall",
                header_x,
                header_y
            );

            reset_shadow();
        }

        // Ticking & Drawing Current Level

        if (level < levels.length) {
            if (started) {
                levels[level].tick();
            }

            if (started) {
                levels[level].draw();
            }
        } else {
            context.font = (size_value / 25) + "px Montserrat";
            context.fillStyle = text_color;

            // Rending Image

            if (window.innerWidth > 800) {
                const img_x = size_value / 1.005;
                const img_y = size_value / 15;

                context.translate(img_x, img_y);
                context.rotate(0.025);
                context.translate(-img_x, -img_y);
                context.drawImage(image_3, img_x, img_y, image_3.width * (size_value / 1800), image_3.height * (size_value / 1700));
                context.resetTransform();
            }

            // Removing Info Texts

            let level_count = 0;

            for (let i = 0; i < levels.length; i++) {
                if (levels[i].answers[0][1] !== 2) {
                    level_count++;
                }
            }

            // Entering Text

            const text = ["Du hast " + score + "/" + level_count + " Fragen", "richtig beantwortet.", ""];

            if (score <= level_count / 3) {
                text.push("Schache Leistung mein Lieber");
            } else if (score <= level_count / 1.5) {
                text.push("Mittelmäßig");
            } else {
                text.push("Hervorragend!");
            }

            // Rending Text

            for (let i = 0; i < text.length; i++) {
                const measure = context.measureText(text[i]);

                shadow("#00000050", 15, size_value / 200);

                context.fillText(
                    text[i],
                    window.innerWidth / 2 - measure.width / 2,
                    window.innerHeight / 2 + (size_value / 20) * i + wobble
                );
            }

            reset_shadow();
        }

        // Ticking Global Timer

        if (hover_cooldown > 0) {
            hover_cooldown--;
        }

        if (click_cooldown > 0) {
            click_cooldown--;
        }

        if (theme_cooldown > 0) {
            theme_cooldown--;
        }

        // Updating Score Bar

        document.getElementById("score").textContent = "Score: " + score;

        // Recursion Drawing

        requestAnimationFrame(draw);
    }

    // Color Utils

    function shade_color(color, percent) {
        color = color.substring(1);

        const num = parseInt(color, 16);
        const amount = Math.round(2.55 * percent);

        const red = (num >> 16) + amount;
        const green = (num >> 8 & 0x00FF) + amount;
        const blue = (num & 0x0000FF) + amount;

        return '#' + (0x1000000 + (red < 255 ? red < 1 ? 0 : red : 255) * 0x10000 + (green < 255 ? green < 1 ? 0 : green : 255) * 0x100 + (blue < 255 ? blue < 1 ? 0 : blue : 255)).toString(16).slice(1);
    }

    // Level

    class Level {
        constructor(colors, text, answers, image) {
            this.colors = colors;

            // Text

            this.text = text;
            this.answers = answers;

            this.prev_hover = -1;
            this.hover_ticks = 0;

            // Text Shaking

            this.shake = [];

            // Image

            this.image = image;
            this.img_x = Math.random() >= 0.5 ? size_value / 500 + (image !== null ? image.width / 10 : 0) : size_value / 1.15 - (image !== null ? image.width / 10 : 0);
            this.img_y = Math.random() * 100 + 150 - (image !== null ? image.height / 3.5 : 0);
            this.img_rot = Math.random() / 10 * (Math.random() >= 0.5 ? -1 : 1);

            // Wrong Count

            this.wrong_count = 0;
        }

        // Updating

        update() {

        }

        tick() {
            for (let i = 0; i < this.shake.length; i++) {
                if (this.shake[i][1] <= 0) {
                    this.shake.splice(i, 1);
                    i--;
                } else {
                    this.shake[i] = [this.shake[i][0], this.shake[i][1] - 1, this.shake[i][2], this.shake[i][3]];
                }
            }
        }

        // Drawing

        draw() {
            context.font = (size_value / 30) + "px Montserrat";
            context.fillStyle = text_color;

            // Rendering Text

            for (let i = 0; i < this.text.length; i++) {
                const measure = context.measureText(this.text[i]);

                shadow("#00000050", 15, size_value / 200);

                context.fillText(
                    this.text[i],
                    window.innerWidth / 2 - measure.width / 2,
                    window.innerHeight / 2 + (size_value / 20) * (i - 1)
                );
            }

            reset_shadow();

            // Measuring Answer Width

            let answer = "";

            for (let i = 0; i < this.answers.length; i++) {
                answer += this.answers[i];
            }

            let measure_width = context.measureText(answer).width;

            if (this.answers.length === 1) {
                measure_width = 0;
            }

            // Getting Hovered Over Answer

            let hover = -1;

            if (mouse_x !== prev_mouse_x || mouse_y !== prev_mouse_y) {
                if (measure_width < window.innerWidth / 1.5) {
                    for (let i = 0; i < this.answers.length; i++) {
                        const answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2 + ((i - (this.answers.length / 3)) * measure_width / 2);
                        const answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length);

                        if (mouse_x > answer_x - (size_value / 40) && mouse_x < answer_x + context.measureText(this.answers[i][0]).width + (size_value / 40)
                            && mouse_y > answer_y - (size_value / 40) && mouse_y < answer_y + (size_value / 40)) {

                            hover = i;
                            break;
                        }
                    }
                } else {
                    for (let i = 0; i < this.answers.length; i++) {
                        let answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2;
                        let answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length + i);

                        if (mouse_x > answer_x - (size_value / 40) && mouse_x < answer_x + context.measureText(this.answers[i][0]).width * 1.05 + (size_value / 40)
                            && mouse_y > answer_y - (size_value / 40) && mouse_y < answer_y + (size_value / 40)) {

                            hover = i;
                            break;
                        }
                    }
                }
            } else {
                hover = this.prev_hover;
            }

            // Hover Effect Ticking

            if (this.prev_hover === -1 && hover !== -1) {
                this.prev_hover = hover;
                this.hover_ticks += 5;

                if (hover_cooldown === 0 && !muted) {
                    hover_sound.cloneNode(true).play();
                }
            } else if (this.prev_hover === hover && hover !== -1) {
                this.hover_ticks += 5;
            } else {
                this.prev_hover = -1;
                this.hover_ticks = 0;
            }

            // Rendering Answers

            context.font = (size_value / 40) + "px Montserrat";

            if (measure_width < window.innerWidth / 1.5) {
                for (let i = 0; i < this.answers.length; i++) {
                    if (hover === i) {
                        shadow(text_color === "#EFEFEF" ? shade_color("#FFFFFF", this.hover_ticks * 6.66) : "#323232", this.hover_ticks > 100 ? 15 : this.hover_ticks / 6.66, 0);
                    }

                    // Position Calculation

                    let answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2 + ((i - (this.answers.length / 3)) * measure_width / 2);
                    let answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length);

                    // Shake Effect Offset

                    for (let j = 0; j < this.shake.length; j++) {
                        if (this.shake[j][0] === i) {
                            let shake_x = Math.random() * (Math.random() >= 0.5 ? -1 : 1) * 2;
                            let shake_y = Math.random() * (Math.random() >= 0.5 ? -1 : 1) * 2;

                            shake_x = this.shake[j][2] * 0.25 + shake_x * 0.85;
                            shake_y = this.shake[j][3] * 0.25 + shake_y * 0.85;

                            this.shake[j] = [this.shake[j][0], this.shake[j][1], shake_x, shake_y];

                            answer_x += shake_x;
                            answer_y += shake_y;
                        }
                    }

                    // Rendering Hover Layer

                    context.fillStyle = text_color;

                    context.fillText(
                        this.answers[i][0],
                        answer_x,
                        answer_y
                    );

                    // Rendering Shadow Layer

                    context.fillStyle = text_color;
                    shadow("#00000050", 15, size_value / 200);

                    context.fillText(
                        this.answers[i][0],
                        answer_x,
                        answer_y
                    );

                    reset_shadow();
                }
            } else {
                for (let i = 0; i < this.answers.length; i++) {
                    if (hover === i) {
                        shadow(text_color === "#EFEFEF" ? shade_color("#FFFFFF", this.hover_ticks * 6.66) : "#323232", this.hover_ticks > 100 ? 15 : this.hover_ticks / 6.66, 0);
                    }

                    // Position Calculation

                    let answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2;
                    let answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length + i);

                    // Shake Effect Offset

                    for (let j = 0; j < this.shake.length; j++) {
                        if (this.shake[j][0] === i) {
                            let shake_x = Math.random() * (Math.random() >= 0.5 ? -1 : 1) * 2;
                            let shake_y = Math.random() * (Math.random() >= 0.5 ? -1 : 1) * 2;

                            shake_x = this.shake[j][2] * 0.25 + shake_x * 0.85;
                            shake_y = this.shake[j][3] * 0.25 + shake_y * 0.85;

                            this.shake[j] = [this.shake[j][0], this.shake[j][1], shake_x, shake_y];

                            answer_x += shake_x;
                            answer_y += shake_y;
                        }
                    }

                    // Rendering Hover Layer

                    context.fillStyle = text_color;

                    context.fillText(
                        this.answers[i][0],
                        answer_x,
                        answer_y
                    );

                    // Rendering Shadow Layer

                    context.fillStyle = text_color;
                    shadow("#00000050", 15, size_value / 200);

                    context.fillText(
                        this.answers[i][0],
                        answer_x,
                        answer_y
                    );

                    reset_shadow();
                }
            }
        }

        // Mouse Clicked

        mouse_clicked(x, y) {
            if (level >= levels.length) return;

            let answer = "";
            let input = -1;
            let index = -1;

            // Answer Box Calculation

            context.font = (size_value / 30) + "px Montserrat";
            context.fillStyle = text_color;

            for (let i = 0; i < this.answers.length; i++) {
                answer += this.answers[i];
            }

            let measure_width = context.measureText(answer).width;

            if (this.answers.length === 1) {
                measure_width = 0;
            }

            if (measure_width < window.innerWidth / 1.5) {
                for (let i = 0; i < this.answers.length; i++) {
                    const answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2 + ((i - (this.answers.length / 3)) * measure_width / 2);
                    const answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length);

                    if (x > answer_x - (size_value / 40) && x < answer_x + context.measureText(this.answers[i][0]).width + (size_value / 40)
                        && y > answer_y - (size_value / 40) && y < answer_y + (size_value / 40)) {

                        input = this.answers[i][1];
                        index = i;
                        break;
                    }
                }
            } else {
                for (let i = 0; i < this.answers.length; i++) {
                    let answer_x = window.innerWidth / 2 - context.measureText(this.answers[i][0]).width / 2;
                    let answer_y = window.innerHeight / 2 + (size_value / 20) * (this.text.length + i);

                    if (x > answer_x - (size_value / 40) && x < answer_x + context.measureText(this.answers[i][0]).width * 1.05 + (size_value / 40)
                        && y > answer_y - (size_value / 40) && y < answer_y + (size_value / 40)) {

                        input = this.answers[i][1];
                        index = i;
                        break;
                    }
                }
            }

            // Result

            if (input === 1) {
                this.next_level();
                if (!muted) {
                    click_sound.cloneNode(true).play();
                }
            } else if (input === 2) {
                hover_cooldown = 25;
                level++;
                if (level < levels.length - 1) levels[level].update();
                if (!muted) {
                    click_sound.cloneNode(true).play();
                }
            } else if (input !== -1 && click_cooldown === 0) {
                if (!muted) {
                    wrong_sound.cloneNode(true).play();
                }
                click_cooldown = 10;
                this.shake.push([index, 25, 0, 0]);
                this.wrong_count++;

                document.getElementById("score").textContent = "Score: " + score;
            }
        }

        // Key Down

        key_pressed(key) {
            if (key > 0 && key - 1 < this.answers.length && this.answers[key - 1][1] === true) {
                this.next_level();
                if (!muted) {
                    click_sound.cloneNode(true).play();
                }
            } else if (key > 0 && key - 1 < this.answers.length && click_cooldown === 0) {
                if (!muted) {
                     wrong_sound.cloneNode(true).play();
                }
                click_cooldown = 10;
                this.shake.push([key - 1, 25, 0, 0]);
                this.wrong_count++;

                document.getElementById("score").textContent = "Score: " + score;
            }
        }

        // Next Level

        next_level() {
            hover_cooldown = 25;

            level++;
            if (level < levels.length - 1) levels[level].update();

            if (this.wrong_count === 0) {
                score++;
            }
        }
    }

    // Waves

    class Wave {
        constructor(color, nodes, wave_speed, y) {
            this.color = color;
            this.nodes = [];
            this.y = y;

            for (let i = 0; i <= nodes + 2; i++) {
                this.nodes.push([(i - 1) * window.innerWidth / nodes, 0, Math.random() * 200, wave_speed]);
            }
        }

        // Updating

        update() {
            for (let i = 0; i < this.nodes.length; i++) {
                this.nodes[i] = [
                    (this.nodes[i][0] / (prev_width / (this.nodes.length - 2))) * (window.innerWidth / (this.nodes.length - 2)),
                    this.nodes[i][1],
                    this.nodes[i][2],
                    this.nodes[i][3]
                ];
            }
        }

        // Drawing

        draw() {
            const diff = function (a, b) {
                return (b - a) / 2 + a;
            };

            context.fillStyle = this.color;
            context.beginPath();
            context.moveTo(0, window.innerHeight);
            context.lineTo(this.nodes[0][0], this.nodes[0][1]);

            for (let i = 0; i < this.nodes.length; i++) {
                if (this.nodes[i + 1]) {
                    context.quadraticCurveTo(
                        this.nodes[i][0], this.nodes[i][1],
                        diff(this.nodes[i][0], this.nodes[i + 1][0]),
                        diff(this.nodes[i][1], this.nodes[i + 1][1])
                    );
                } else {
                    context.lineTo(this.nodes[i][0], this.nodes[i][1]);
                    context.lineTo(window.innerWidth, window.innerHeight);
                }
            }

            context.closePath();
            context.fill();
        }
    }

    // Utils

    function bounce(wave, wave_height, nodes) {
        nodes[1] = wave_height / 2 * Math.sin(nodes[2] / 20) + window.innerHeight / 2 + wave.y;
        nodes[2] = nodes[2] + nodes[3];
    }

    function shadow(color, blur, offset_y) {
        context.shadowColor = color;
        context.shadowBlur = blur;
        context.shadowOffsetY = offset_y;
    }

    function reset_shadow() {
        context.shadowColor = "#00000000";
        context.shadowOffsetY = 0;
        context.shadowBlur = 0;
    }

</script>

</body>

</html>
